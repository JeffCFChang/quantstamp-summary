# Quantstamp: 智能合约安全协议

~~本来想要直接翻译白皮书，后来发现工作量也不小，写个大概吧。去掉技术细节的晦涩部分，保留方便理解整个系统的部分~~

**Quantstamp是第一个智能合约安全审计协议。** 我们用可以确保智能合约安全性的技术来拓展以太坊。我们的团队是由一群软件测试专家组成，总共超过500个谷歌学者引用。

## 问题
区块链网络是安全的，但是智能合约并不安全。2016年6月，黑客从DAO项目中盗取了价值5500万美元的币，原因是智能合约中的一个缺陷。2017年7月，有黑客从加密公司盗取了价值超过3000万美元的代币，只因为Parity钱包的智能合约代码中的一个单词错误。这些安全问题损坏了对智能合约的信任，进一步也阻碍了以太坊网络被更广泛地使用。

当前人们对审计智能合作做的很不充分。从事安全咨询的公司需要人工专家去审核智能合约。这种处理方式昂贵且容易出错。并且依赖于一个公司，需要相信公司中没有任何坏角色。一个依赖于多种不同角色共识的分布式系统显著地更为安全。

人工审计的处理方式，无法应对智能合约的爆炸式增长。2017年6月到10月，智能合约的数量，从50万增长到了200万。我们可以预期1年内会增长为1000万。这对审计工作会有指数级的增长。如今我们没有足够的安全专家来审计所有的智能合约，并且这个短缺未来会更为严峻。

智能合约失败的潜在代价也会增长。仅仅2017年10月，约有32亿美元(1100万ETH)在智能合约中锁定这。而锁定在智能合约中的美元会随着以太坊和智能合约使用的增长而指数级增长。智能合约中漏洞的潜在带带也会相应增长。

## Quantstamp协议
Quantstamp协议通过创建可伸缩低成本的系统审计所有以太坊网络的网络的智能合约，来解决智能合约的安全问题。随着时间的推移，我们希望每一个以太坊智能合约都使用Quantstamp协议来执行安全审计，安全是最基本的。  

协议包含两部分：
- 一个自动且可升级的软件验证系统，用于检查Solidity程序。分布式SAT解析器会需要大量的算力，但随着时间推移，会捕获到更为复杂的攻击。
- 一个自动的赏金支付系统，用于奖励查找合约缺陷的人工参与者。这个系统的目的，是桥接起通往全自动化目标的隔阂。

Quantstamp协议依赖于参与者们的分布式网络，来减轻坏角色的作用，提供所需的算力，还有提供管治。每一个参与者都使用Quantstamp协议（QSP）令牌来支付，接收，或者提高验证服务。下面是不同类型的参与者。

- **贡献者** 为Solidity验证程序贡献软件，然后获得QSP令牌。所有贡献的带慕都会开源，这样社区可以对效率有所信任。绝大部分的贡献者将会是安全专家。贡献是通过管治机制来投票的。
- **验证器** 运行Quantstamp验证节点并获得QSP令牌。验证着只是贡献计算资源，不需要是安全专家。
- **缺陷寻找者** 提交智能合约缺陷，获得QSP令牌作为赏金。
- **合约创建者** 支付QSP令牌验证以验证智能合约。由于智能合约的数量在爆炸式增长，我们预计合约穿件这的需求也会相应增长。
- **合约使用者** 可以查看智能合约的安全审计结果。
- **投票者** 官职系统是协议的一个核心特性。验证被设计为模块化的并且可以基于令牌持有者的投票来升级。管治机制减少了升级分叉的可能性，也会随着时间推移，去中心化创建团队的影响。

## 动机
我们团队成员的职业都在帮助开发者生产更可靠的代码，具备软件验证学科上，多年的科学研究和实战经验。


## 智能合约改进
### 我们如何改进智能合约架构
该协议允许对智能契约代码进行自动安全检查，并以一种不信任的方式进行检查。我们的方法提供了以下两个核心优势。
1。该协议允许终端用户直接提交程序进行验证，而不可能通过操纵审核结果的坏参与者。
想象一下，一家安全审计公司的一名不佳的演员，可以让数百万美元的漏洞溜过，然后利用现场部署的合同。基于经济主导的战略，定量协议所要求的共识降低了坏参与者的影响，试图操纵结果的代价太大了。经过验证的智能契约是由审核的散列生成的，其中包括验证器使用的安全库的版本，基于共识的纯文本报告发布。在未来，我们计划与第三方合作提供智能合同保险，以进一步降低使用智能合同的风险。
2。我们通过认证和认证智能合同来激励矿商在以太坊进行验证节点软件
在区块链架构中,“矿工”参与实体事务添加到链。在quant图章协议中，矿工被称为“验证者”。验证器需要运行验证节点软件，该软件可以在quant图章验证智能契约上监视更新。执行服务的费用使验证人诚实。验证合同的验证人会产生一种验证式的哈希，反过来，验证人也会获得象征性的费用。如果一个验证人发现违反了合同的安全目标，他/他就会产生一个反例，这是对违规行为的证人，而第三方托管智能合同向验证方支付了赏金。开发人员在找到漏洞时负责处理漏洞，但是现在，他们可以在涉及到真正的利害关系之前解决这些漏洞。
### 我们如何改进开发者流程
出于好意的软件开发人员需要帮助来生成更好的代码。Luu等。指出,有一个语义鸿沟植根于theblockchain代码执行的误解;因此，迫切需要更好的工具，可以帮助开发人员在部署之前捕获漏洞。目前开发人员测试代码的方式——手动地通过开源代码评审和单元测试(如果他们是勤奋的)——是不足以满足区块链技术的需求的，这种技术在理想情况下提供了完美的安全性。以上所有方法都是非常手工的方法，允许人为错误。我们需要一个简单的过程来验证聪明的合同，同时尽可能减少严重漏洞的可能性。quant集邮协议提供了这个简单的接口，同时也通过在区块链上证明他们执行了这个审计，从而保护了开发者的声誉。
### Quantstamp示例
假设一个开发人员计划在以太坊上部署一份可靠的合同。在编写访问货币系统的代码时，存在很大的风险，开发人员必须小心确保没有因漏洞而丢失的资金。为了最小化风险，开发人员通过quant邮票Ethereum智能契约直接从他的钱包、数据字段的源代码和发送QSP标记来提交安全审计的代码。根据程序的安全需求，开发人员可以决定发送多少赏金。然后，智能契约接收请求，然后在下一个Ethereum块验证节点执行一组安全检查，以验证智能契约。在一致的情况下，将验证和报告数据添加到下一个以太坊，并附带适当的令牌支付。报告将基于严重系统的问题分类为1-10;l是一个很小的警告，10是一个主要的弱点。从这一点开始，如果一个严重的漏洞没有立即被检测到，那么赏金就会一直存在，直到指定的时间已经过去。在这段时间结束时，将返回给请求审计的开发人员。在请求审计时，开发人员选择公开或私有的安全报告。私人报告使用智能契约的公钥加密，可以由所有者/开发人员解密。开发人员和公众可以访问一个名为qsscan的web门户。io检查任何安全报告。门户通过quant图章智能契约对事务数据字段中的信息进行解析，并显示它。通过使用审核的散列，公众看到的安全报告与经过审计的源代码完全匹配，以防止对报告结果的操作。
在发布公共审计之前，开发人员可以在本地机器上执行安全审计，但是可能发现计算开销过高。与普通的开发人员机器相比，在内存和处理核心方面，量子戳验证器节点的计算能力可能更强。同样，通过将人类黑客的强大力量聚集在一起，这个项目能够大大超过标准代码审查的覆盖范围。一旦代码准备好进行部署，开发人员最终会产生一个公共安全报告，以便让用户放心地执行一个分散的安全审计。
当安全报告识别出在智能合同中发现的问题时，开发人员可以公开注释qsscan。io和反馈。这使开发人员能够在报告中标记假阳性，社区可以验证注释。
quant集邮并不能保证完美的源代码，但是通过使用自动化和众包方法，可以确保代码是安全的。
quant图章团队致力于不断地进行研究和开发，定期对安全库进行改进。当有新版本发布时，开发人员可以重新审核他们的智能契约，展示他们对保护代码和增强公众信心的承诺。
非开发人员将对项目有更多的信心，因为他们可以看到聪明的合同开发人员是否已经对他们的代码进行了审计，以及对哪个版本进行了审计。

## 技术
### 校验协议
#### 设计
### 安全审计引擎
### 架构图
#### Quantstamp校验智能合约
#### Quantstamp网络
#### Quantstamp报告
### 交换方式
#### 计算机辅助推理工具
##### SAT解析器
##### SMT解析器
#### 模型检查
#### 静态程序分析
#### 符号执行及Concolic testing
### 增量发布和订阅模型
### 缺陷查找器
### 安全泄露策略
### 分布并行SAT
#### 可满足性问题(SAT)
#### 并行SAT解析器
#### 并行SAT与共识
### 以太坊/Solidity的常见漏洞
## 财务计划
## 团队调研贡献
### Demo:定位Parity多方签名漏洞
## 常见问题与解答
## 详细履历
## 附录A
## 附录B
## 附录C






