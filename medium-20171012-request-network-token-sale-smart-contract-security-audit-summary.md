# Request Network令牌销售智能合约安全审计摘要

最近，我们在[Quantstamp](https://quantstamp.com/)审核了[Request.Network](https://request.network)的令牌销售智能合约，以帮助他们保证安全可靠的令牌销售。

经审计的合同可在这里获得： [https://github.com/quantstamp/RequestNetwork_Review](https://github.com/quantstamp/RequestNetwork_Review)

简言之，Request Network令牌销售智能合约绝大多数通过了我们的安全审计。 总体意见包括：
- 大量使用广泛测试的开源代码;
- 坚持最佳实践;
- 选择简单，而非复杂;
- 全面的代码覆盖单元测试; 以及 
- 谨慎使用守卫/修饰符来避免大量的漏洞。

在安全性方面，我们必须预期到不期而至（expect the unexpected），Request.Network智能合约将这个口头禅烂熟于中。充分利用onlyOwner守护者确保众筹时访问某些功能被限制在可信的Ethereum帐户。 他们仔细防范了像去年困扰DAO那样的重放漏洞，使用一个安全的数据操作来避免整数溢出的问题。 我们还认为允许RequestNetwork团队提取错误发送到合约中的令牌被排除是非常明智的。

Request.Network通过对他们的代码中的细节的关注和注意力给我们留下了深刻的印象。我们只看到一些很小的问题。他们立即处理了我们的疑虑，并已经做出了一个非常棒的令牌销售智能合约。

我们确实注意到一个关于Request.Network的自动化测试套件的事情 - 它没有立即工作。 确保测试文件以确定的方式执行是非常重要的，但区块链时间数据的状态在测试文件之间没有正确更新。这将导致由于startTime参数不大于now而导致RequestTokenSale合同的创建失败。 为了使所有测试正常运行，在每次创建一个RequestTokenSale之前，都会适当地调用addsDayOnEVM()函数。

由于硬编码的日期值，我们确定了一个错误的测试用例。 此测试确保RequestTokenSale无法在开始日期之前的结束日期实例化。硬编码日期导致与实际的当前日期无法预见的交互，这可能是最初写测试时没有发生的。 将常数更新为适当的值后，测试符合预期通过。

目前，我们执行人工和自动组合检查。 随着我们的项目成熟，我们将更多的审计流程自动化。对一些漏洞，我们使用静态分析和可达性程序积极测试。 同时，我们的高级软件工程师Ed正在为自动测试案例生成器开发一个功能强大的fuzzer。 目前，从不同项目切换时候，fuzzer需要Ed的专业知识来进行调整，他正在努力将其一般化，以支持更广泛地使用。

Solidity编程的一个挑战是，您认为发生的情况可能并不是这样（也就是“语义差异”）。我们的工程师每一步采取“攻击者”的心态。我们质疑每个设计决策，每一行代码，并设想数百万美元处于危险之中。 我们一个场景接着场景跟踪，并将每个场景映射到EVM执行模型。

我们作为一个团队所做的最重要的事情之一就是无休止地相互询问：“如果……怎么样？” 要自动化的想法激励我们采用这种方式的，这样会加强我们的安全库。如果把一群白帽子的黑客一起放在房间里时所能发生的那样。最终，我们可扩展的分散式模型将会将数以万计的白帽黑客与高级自动推理工具集成在一起，一起问“如果……怎么样？”，并在基于共识的环境中测试这些场景。

我们很高兴与Request.Network建立了合作伙伴关系。 我们不仅对他们的项目感到兴奋，Etienne（CTO）和Vincent（主要开发人员）也都是伟大的区块链梦幻人物，他们分享了我们对区块链的信念，区块链将改善人们生活念。

### 关于Request Netwrok

*Request是分散的网络，允许任何人发起支付请求（请求发票），接收者可以以安全的方式支付。所有信息都存储在分散的真实分类帐中。这样会导致更便宜，更简单和更安全的支付，并且使得广泛的自动化可能性。Request集成了总帐（会计术语），旨在支持100％的全球交易，无论任何货币，法律或语言。Request可以被看作是以太坊上的一层，使得支付请求能够满足法律框架的需求。请参阅[Request Network白皮书](https://request.network/assets/pdf/request_whitepaper.pdf)了解更多信息。*


### 关于Quantstamp

*Quantstamp协议通过创建可扩展且低成本的系统来审计Ethereum网络上的所有智能合约，来解决智能合约安全问题。

随着时间推移，我们预计每个Ethereum智能合约都将使用Quantstamp协议执行安全审核。
协议由两部分组成：
1. 一个自动升级的软件验证系统，用于检查Solidity程序。 冲突驱动的分布式SAT求解器需要大量的计算能力，但是随着时间的推移能够捕获越来越复杂的攻击。
2. 一个自动奖金支付系统，奖励人类参与者在智能合约中发现错误。  

该系统的目的是弥合差距，同时实现全自动化的目标。 查看我们的网站 [www.quantstamp.com](http://www.quantstamp.com/) 了解更多。*